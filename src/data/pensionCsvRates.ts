// src/data/pensionCsvRates.ts
import type { PensionPlanType } from "./pensionRates";
import type { Gender } from "../hooks/useLthcTypes";

// --- 1. เก็บข้อมูลดิบในรูปแบบที่ง่ายและสั้น ---
// [อายุแรกเข้า, ปีกรมธรรม์, CSV8 ชาย, CSV8 หญิง, CSV60 ชาย, CSV60 หญิง]
const rawCsvData = [
  [20, 1, 32, 35, 0, 0],
  [20, 2, 135, 145, 22, 24],
  [20, 3, 351, 375, 67, 73],
  [20, 4, 550, 587, 116, 126],
  [20, 5, 788, 840, 165, 180],
  [20, 6, 969, 1033, 220, 240],
  [20, 7, 1155, 1230, 281, 307],
  [20, 8, 1346, 1433, 331, 362],
  [20, 9, 1379, 1468, 383, 419],
  [20, 10, 1413, 1505, 436, 478],
  [20, 11, 1448, 1542, 491, 538],
  [20, 12, 1483, 1581, 546, 599],
  [20, 13, 1520, 1620, 604, 662],
  [20, 14, 1557, 1660, 662, 727],
  [20, 15, 1596, 1702, 723, 793],
  [20, 16, 1636, 1744, 784, 861],
  [20, 17, 1676, 1788, 848, 930],
  [20, 18, 1718, 1833, 913, 1001],
  [20, 19, 1761, 1878, 979, 1074],
  [20, 20, 1805, 1925, 1048, 1149],
  [20, 21, 1850, 1974, 1118, 1226],
  [20, 22, 1896, 2023, 1190, 1305],
  [20, 23, 1944, 2074, 1264, 1386],
  [20, 24, 1992, 2125, 1340, 1469],
  [20, 25, 2042, 2178, 1418, 1554],
  [20, 26, 2093, 2233, 1498, 1641],
  [20, 27, 2145, 2289, 1580, 1730],
  [20, 28, 2199, 2346, 1665, 1822],
  [20, 29, 2254, 2405, 1752, 1917],
  [20, 30, 2310, 2465, 1842, 2013],
  [20, 31, 2368, 2526, 1934, 2112],
  [20, 32, 2427, 2590, 2028, 2214],
  [20, 33, 2488, 2654, 2124, 2318],
  [20, 34, 2550, 2721, 2223, 2424],
  [20, 35, 2614, 2789, 2325, 2533],
  [20, 36, 2679, 2858, 2429, 2645],
  [20, 37, 2746, 2930, 2535, 2760],
  [20, 38, 2815, 3003, 2644, 2878],
  [20, 39, 2885, 3078, 2756, 2999],
  [20, 40, 2957, 3155, 2871, 3122],
  [21, 1, 33, 36, 0, 0],
  [21, 2, 139, 149, 23, 25],
  [21, 3, 360, 385, 70, 76],
  [21, 4, 564, 602, 121, 131],
  [21, 5, 808, 861, 172, 187],
  [21, 6, 993, 1059, 229, 250],
  [21, 7, 1184, 1261, 292, 320],
  [21, 8, 1379, 1468, 345, 377],
  [21, 9, 1413, 1505, 399, 437],
  [21, 10, 1448, 1542, 454, 498],
  [21, 11, 1483, 1581, 511, 560],
  [21, 12, 1520, 1620, 569, 624],
  [21, 13, 1557, 1660, 629, 689],
  [21, 14, 1596, 1702, 690, 757],
  [21, 15, 1636, 1744, 753, 825],
  [21, 16, 1676, 1788, 817, 896],
  [21, 17, 1718, 1833, 863, 968],
  [21, 18, 1761, 1878, 951, 1043],
  [21, 19, 1805, 1925, 1020, 1119],
  [21, 20, 1850, 1974, 1091, 1197],
  [21, 21, 1896, 2023, 1164, 1277],
  [21, 22, 1944, 2074, 1239, 1359],
  [21, 23, 1992, 2125, 1316, 1443],
  [21, 24, 2042, 2178, 1396, 1529],
  [21, 25, 2093, 2233, 1477, 1618],
  [21, 26, 2145, 2289, 1561, 1709],
  [21, 27, 2199, 2346, 1647, 1802],
  [21, 28, 2254, 2405, 1735, 1898],
  [21, 29, 2310, 2465, 1826, 1996],
  [21, 30, 2368, 2526, 1919, 2097],
  [21, 31, 2427, 2590, 2015, 2200],
  [21, 32, 2488, 2654, 2113, 2305],
  [21, 33, 2550, 2721, 2214, 2414],
  [21, 34, 2614, 2789, 2317, 2525],
  [21, 35, 2679, 2858, 2422, 2639],
  [21, 36, 2746, 2930, 2530, 2755],
  [21, 37, 2815, 3003, 2641, 2875],
  [21, 38, 2885, 3078, 2755, 2997],
  [21, 39, 2957, 3155, 2871, 3123],
  [22, 1, 34, 37, 0, 0],
  [22, 2, 142, 153, 24, 26],
  [22, 3, 369, 395, 73, 79],
  [22, 4, 579, 618, 126, 137],
  [22, 5, 828, 883, 179, 195],
  [22, 6, 1018, 1085, 239, 261],
  [22, 7, 1213, 1292, 305, 333],
  [22, 8, 1413, 1505, 360, 394],
  [22, 9, 1448, 1542, 416, 455],
  [22, 10, 1483, 1581, 474, 519],
  [22, 11, 1520, 1620, 533, 584],
  [22, 12, 1557, 1660, 593, 650],
  [22, 13, 1596, 1702, 656, 719],
  [22, 14, 1636, 1744, 719, 789],
  [22, 15, 1676, 1788, 785, 861],
  [22, 16, 1718, 1833, 852, 934],
  [22, 17, 1761, 1878, 921, 1010],
  [22, 18, 1805, 1925, 991, 1087],
  [22, 19, 1850, 1974, 1064, 1166],
  [22, 20, 1896, 2023, 1138, 1248],
  [22, 21, 1944, 2074, 1214, 1331],
  [22, 22, 1992, 2125, 1293, 1417],
  [22, 23, 2042, 2178, 1373, 1505],
  [22, 24, 2093, 2233, 1456, 1595],
  [22, 25, 2145, 2289, 1541, 1687],
  [22, 26, 2199, 2346, 1628, 1782],
  [22, 27, 2254, 2405, 1718, 1879],
  [22, 28, 2310, 2465, 1811, 1979],
  [22, 29, 2368, 2526, 1905, 2082],
  [22, 30, 2427, 2590, 2003, 2186],
  [22, 31, 2488, 2654, 2102, 2294],
  [22, 32, 2550, 2721, 2205, 2404],
  [22, 33, 2614, 2789, 2309, 2517],
  [22, 34, 2679, 2858, 2417, 2633],
  [22, 35, 2746, 2930, 2527, 2751],
  [22, 36, 2815, 3003, 2640, 2873],
  [22, 37, 2885, 3078, 2755, 2997],
  [22, 38, 2957, 3155, 2874, 3125],
  [23, 1, 35, 38, 0, 0],
  [23, 2, 146, 158, 25, 27],
  [23, 3, 379, 406, 76, 83],
  [23, 4, 594, 634, 131, 143],
  [23, 5, 849, 906, 187, 204],
  [23, 6, 1043, 1113, 249, 272],
  [23, 7, 1243, 1325, 318, 347],
  [23, 8, 1448, 1542, 375, 410],
  [23, 9, 1483, 1581, 434, 475],
  [23, 10, 1520, 1620, 494, 541],
  [23, 11, 1557, 1660, 556, 609],
  [23, 12, 1596, 1702, 619, 678],
  [23, 13, 1636, 1744, 684, 749],
  [23, 14, 1676, 1788, 750, 823],
  [23, 15, 1718, 1833, 818, 897],
  [23, 16, 1761, 1878, 888, 974],
  [23, 17, 1805, 1925, 960, 1053],
  [23, 18, 1850, 1974, 1034, 1134],
  [23, 19, 1896, 2023, 1109, 1216],
  [23, 20, 1944, 2074, 1187, 1301],
  [23, 21, 1992, 2125, 1266, 1388],
  [23, 22, 2042, 2178, 1348, 1477],
  [23, 23, 2093, 2233, 1432, 1569],
  [23, 24, 2145, 2289, 1519, 1663],
  [23, 25, 2199, 2346, 1607, 1760],
  [23, 26, 2254, 2405, 1699, 1859],
  [23, 27, 2310, 2465, 1793, 1960],
  [23, 28, 2368, 2526, 1890, 2064],
  [23, 29, 2427, 2590, 1988, 2171],
  [23, 30, 2488, 2654, 2090, 2280],
  [23, 31, 2550, 2721, 2194, 2392],
  [23, 32, 2614, 2789, 2300, 2507],
  [23, 33, 2679, 2858, 2410, 2625],
  [23, 34, 2746, 2930, 2521, 2745],
  [23, 35, 2815, 3003, 2636, 2869],
  [23, 36, 2885, 3078, 2754, 2996],
  [23, 37, 2957, 3155, 2874, 3126],
   [24, 1, 36, 40, 0, 0],
  [24, 2, 151, 162, 26, 29],
  [24, 3, 389, 417, 80, 87],
  [24, 4, 609, 650, 137, 149],
  [24, 5, 870, 929, 195, 213],
  [24, 6, 1069, 1141, 260, 284],
  [24, 7, 1274, 1358, 332, 363],
  [24, 8, 1483, 1581, 392, 429],
  [24, 9, 1520, 1620, 453, 496],
  [24, 10, 1557, 1660, 516, 565],
  [24, 11, 1596, 1702, 580, 636],
  [24, 12, 1636, 1744, 646, 709],
  [24, 13, 1676, 1788, 714, 783],
  [24, 14, 1718, 1833, 784, 859],
  [24, 15, 1761, 1878, 855, 937],
  [24, 16, 1805, 1925, 928, 1018],
  [24, 17, 1850, 1974, 1003, 1100],
  [24, 18, 1896, 2023, 1080, 1184],
  [24, 19, 1944, 2074, 1159, 1270],
  [24, 20, 1992, 2125, 1240, 1359],
  [24, 21, 2042, 2178, 1323, 1450],
  [24, 22, 2093, 2233, 1409, 1543],
  [24, 23, 2145, 2289, 1496, 1639],
  [24, 24, 2199, 2346, 1587, 1737],
  [24, 25, 2254, 2405, 1680, 1838],
  [24, 26, 2310, 2465, 1776, 1941],
  [24, 27, 2368, 2526, 1874, 2047],
  [24, 28, 2427, 2590, 1975, 2156],
  [24, 29, 2488, 2654, 2078, 2267],
  [24, 30, 2550, 2721, 2184, 2381],
  [24, 31, 2614, 2789, 2293, 2498],
  [24, 32, 2679, 2858, 2404, 2618],
  [24, 33, 2746, 2930, 2518, 2741],
  [24, 34, 2815, 3003, 2635, 2867],
  [24, 35, 2885, 3078, 2755, 2996],
  [24, 36, 2957, 3155, 2877, 3129],
  [25, 1, 37, 41, 0, 0],
  [25, 2, 155, 167, 27, 31],
  [25, 3, 399, 428, 83, 93],
  [25, 4, 624, 667, 143, 158],
  [25, 5, 892, 953, 204, 225],
  [25, 6, 1096, 1170, 272, 299],
  [25, 7, 1305, 1392, 347, 382],
  [25, 8, 1520, 1620, 409, 450],
  [25, 9, 1557, 1660, 473, 521],
  [25, 10, 1596, 1702, 539, 593],
  [25, 11, 1636, 1744, 606, 667],
  [25, 12, 1676, 1788, 675, 142],
  [25, 13, 1718, 1833, 746, 820],
  [25, 14, 1761, 1878, 818, 900],
  [25, 15, 1805, 1925, 893, 981],
  [25, 16, 1850, 1974, 969, 1065],
  [25, 17, 1896, 2023, 1047, 1151],
  [25, 18, 1944, 2074, 1128, 1239],
  [25, 19, 1992, 2125, 1210, 1329],
  [25, 20, 2042, 2178, 1295, 1422],
  [25, 21, 2093, 2233, 1382, 1517],
  [25, 22, 2145, 2289, 1471, 1614],
  [25, 23, 2199, 2346, 1564, 1714],
  [25, 24, 2254, 2405, 1658, 1817],
  [25, 25, 2310, 2465, 1756, 1922],
  [25, 26, 2368, 2526, 1856, 2030],
  [25, 27, 2427, 2590, 1959, 2141],
  [25, 28, 2488, 2654, 2064, 2254],
  [25, 29, 2550, 2721, 2172, 2371],
  [25, 30, 2614, 2789, 2282, 2490],
  [25, 31, 2679, 2858, 2395, 2612],
  [25, 32, 2746, 2930, 2512, 2737],
  [25, 33, 2815, 3003, 2631, 2865],
  [25, 34, 2885, 3078, 2753, 2997],
  [25, 35, 2957, 3155, 2878, 3132],
  [26, 1, 39, 42, 0, 0],
  [26, 2, 159, 171, 29, 34],
  [26, 3, 410, 439, 88, 99],
  [26, 4, 641, 684, 151, 167],
  [26, 5, 915, 977, 214, 237],
  [26, 6, 1124, 1199, 285, 315],
  [26, 7, 1338, 1427, 363, 402],
  [26, 8, 1558, 1661, 429, 173],
  [26, 9, 1596, 1702, 496, 547],
  [26, 10, 1636, 1745, 564, 622],
  [26, 11, 1676, 1788, 634, 699],
  [26, 12, 1718, 1833, 707, 778],
  [26, 13, 1761, 1878, 781, 860],
  [26, 14, 1805, 1925, 856, 943],
  [26, 15, 1850, 1974, 934, 1028],
  [26, 16, 1896, 2023, 1014, 1116],
  [26, 17, 1944, 2074, 1096, 1205],
  [26, 18, 1992, 2125, 1180, 1297],
  [26, 19, 2042, 2178, 1267, 1392],
  [26, 20, 2093, 2233, 1355, 1489],
  [26, 21, 2145, 2289, 1447, 1588],
  [26, 22, 2199, 2346, 1540, 1690],
  [26, 23, 2254, 2405, 1637, 1795],
  [26, 24, 2310, 2465, 1736, 1902],
  [26, 25, 2368, 2526, 1838, 2012],
  [26, 26, 2427, 2590, 1943, 2125],
  [26, 27, 2488, 2654, 2051, 2241],
  [26, 28, 2550, 2721, 2161, 2359],
  [26, 29, 2614, 2789, 2273, 2481],
  [26, 30, 2679, 2858, 2389, 2605],
  [26, 31, 2746, 2930, 2507, 2733],
  [26, 32, 2815, 3003, 2629, 2864],
  [26, 33, 2885, 3078, 2753, 2998],
  [26, 34, 2957, 3155, 2881, 3135],
  [27, 1, 40, 44, 0, 0],
  [27, 2, 164, 176, 32, 37],
  [27, 3, 421, 451, 94, 105],
  [27, 4, 657, 702, 160, 177],
  [27, 5, 939, 1002, 226, 250],
  [27, 6, 1152, 1230, 300, 332],
  [27, 7, 1372, 1463, 383, 423],
  [27, 8, 1597, 1702, 451, 498],
  [27, 9, 1636, 1745, 521, 575],
  [27, 10, 1677, 1788, 593, 653],
  [27, 11, 1718, 1833, 666, 734],
  [27, 12, 1761, 1879, 742, 817],
  [27, 13, 1805, 1925, 819, 902],
  [27, 14, 1850, 1974, 898, 989],
  [27, 15, 1896, 2023, 980, 1078],
  [27, 16, 1944, 2074, 1063, 1170],
  [27, 17, 1992, 2125, 1149, 1264],
  [27, 18, 2042, 2178, 1237, 1360],
  [27, 19, 2093, 2233, 1328, 1459],
  [27, 20, 2145, 2289, 1421, 1560],
  [27, 21, 2199, 2346, 1516, 1665],
  [27, 22, 2254, 2405, 1615, 1771],
  [27, 23, 2310, 2465, 1716, 1881],
  [27, 24, 2368, 2526, 1820, 1993],
  [27, 25, 2427, 2590, 1927, 2109],
  [27, 26, 2488, 2654, 2037, 2227],
  [27, 27, 2550, 2721, 2149, 2348],
  [27, 28, 2614, 2789, 2264, 2472],
  [27, 29, 2679, 2858, 2382, 2599],
  [27, 30, 2746, 2930, 2503, 2729],
  [27, 31, 2815, 3003, 2627, 2863],
  [27, 32, 2885, 3078, 2754, 2999],
  [27, 33, 2957, 3155, 2884, 3140],
  [28, 1, 41, 45, 0, 0],
  [28, 2, 168, 181, 35, 40],
  [28, 3, 432, 163, 100, 112],
  [28, 4, 674, 720, 170, 188],
  [28, 5, 963, 1028, 239, 265],
  [28, 6, 1182, 1261, 317, 351],
  [28, 7, 1406, 1500, 404, 446],
  [28, 8, 1637, 1745, 475, 525],
  [28, 9, 1677, 1788, 549, 605],
  [28, 10, 1719, 1833, 624, 688],
  [28, 11, 1761, 1879, 701, 773],
  [28, 12, 1805, 1925, 780, 860],
  [28, 13, 1850, 1974, 861, 949],
  [28, 14, 1896, 2023, 945, 1040],
  [28, 15, 1944, 2074, 1030, 1134],
  [28, 16, 1992, 2125, 1118, 1230],
  [28, 17, 2042, 2178, 1208, 1328],
  [28, 18, 2093, 2233, 1300, 1429],
  [28, 19, 2145, 2289, 1396, 1533],
  [28, 20, 2199, 2346, 1493, 1639],
  [28, 21, 2254, 2405, 1594, 1749],
  [28, 22, 2310, 2465, 1697, 1861],
  [28, 23, 2368, 2526, 1804, 1976],
  [28, 24, 2427, 2590, 1913, 2094],
  [28, 25, 2488, 2654, 2025, 2214],
  [28, 26, 2550, 2721, 2140, 2338],
  [28, 27, 2614, 2789, 2258, 2465],
  [28, 28, 2679, 2858, 2379, 2595],
  [28, 29, 2746, 2930, 2502, 2728],
  [28, 30, 2815, 3003, 2629, 2865],
  [28, 31, 2885, 3078, 2759, 3005],
  [28, 32, 2957, 3155, 2892, 3149],
  [29, 1, 43, 47, 0, 0],
  [29, 2, 173, 186, 37, 43],
  [29, 3, 444, 475, 107, 120],
  [29, 4, 692, 739, 180, 199],
  [29, 5, 987, 1054, 253, 280],
  [29, 6, 1212, 1293, 335, 370],
  [29, 7, 1552, 1538, 426, 470],
  [29, 8, 1678, 1788, 501, 552],
  [29, 9, 1719, 1833, 578, 637],
  [29, 10, 1762, 1879, 656, 723],
  [29, 11, 1805, 1926, 737, 812],
  [29, 12, 1850, 1974, 820, 903],
  [29, 13, 1896, 2023, 905, 996],
  [29, 14, 1944, 2074, 993, 1092],
  [29, 15, 1992, 2125, 1082, 1190],
  [29, 16, 2042, 2178, 1174, 1291],
  [29, 17, 2093, 2233, 1269, 1394],
  [29, 18, 2145, 2289, 1366, 1500],
  [29, 19, 2199, 2346, 1466, 1609],
  [29, 20, 2254, 2405, 1568, 1720],
  [29, 21, 2310, 2465, 1674, 1835],
  [29, 22, 2368, 2526, 1783, 1952],
  [29, 23, 2427, 2590, 1895, 2073],
  [29, 24, 2488, 2654, 2009, 2196],
  [29, 25, 2550, 2721, 2127, 2323],
  [29, 26, 2614, 2789, 2247, 2452],
  [29, 27, 2679, 2858, 2370, 2585],
  [29, 28, 2746, 2930, 2497, 2722],
  [29, 29, 2815, 3003, 2626, 2861],
  [29, 30, 2885, 3078, 2759, 3004],
  [29, 31, 2957, 3155, 2895, 3151],
  [30, 1, 44, 48, 0, 0],
  [30, 2, 178, 191, 41, 47],
  [30, 3, 456, 488, 114, 128],
  [30, 4, 710, 758, 192, 212],
  [30, 5, 1013, 1081, 269, 296],
  [30, 6, 1242, 1325, 355, 391],
  [30, 7, 1478, 1576, 450, 496],
  [30, 8, 1720, 1833, 529, 582],
  [30, 9, 1762, 1879, 610, 671],
  [30, 10, 1806, 1926, 693, 762],
  [30, 11, 1851, 1974, 778, 855],
  [30, 12, 1896, 2023, 865, 951],
  [30, 13, 1944, 2074, 955, 1049],
  [30, 14, 1992, 2125, 1047, 1149],
  [30, 15, 2042, 2178, 1141, 1252],
  [30, 16, 2093, 2233, 1238, 1358],
  [30, 17, 2145, 2289, 1337, 1466],
  [30, 18, 2199, 2346, 1440, 1578],
  [30, 19, 2254, 2405, 1545, 1692],
  [30, 20, 2310, 2465, 1653, 1809],
  [30, 21, 2368, 2526, 1765, 1930],
  [30, 22, 2427, 2590, 1880, 2053],
  [30, 23, 2488, 2654, 1997, 2179],
  [30, 24, 2550, 2721, 2118, 2309],
  [30, 25, 2614, 2789, 2241, 2442],
  [30, 26, 2679, 2858, 2367, 2578],
  [30, 27, 2746, 2930, 2497, 2718],
  [30, 28, 2815, 3003, 2630, 2861],
  [30, 29, 2885, 3078, 2766, 3007],
  [30, 30, 2957, 3155, 2906, 3157],
  [31, 1, 46, 50, 0, 0],
  [31, 2, 183, 197, 44, 50],
  [31, 3, 468, 501, 122, 136],
  [31, 4, 728, 778, 204, 225],
  [31, 5, 1038, 1109, 285, 314],
  [31, 6, 1274, 1359, 376, 413],
  [31, 7, 1515, 1616, 476, 524],
  [31, 8, 1763, 1879, 559, 615],
  [31, 9, 1806, 1926, 644, 708],
  [31, 10, 1851, 1974, 732, 803],
  [31, 11, 1897, 2023, 821, 301],
  [31, 12, 1944, 2074, 913, 1001],
  [31, 13, 1992, 2125, 1007, 1104],
  [31, 14, 2042, 2178, 1104, 1210],
  [31, 15, 2093, 2233, 1203, 1318],
  [31, 16, 2145, 2289, 1305, 1429],
  [31, 17, 2199, 2346, 1410, 1544],
  [31, 18, 2254, 2405, 1518, 1661],
  [31, 19, 2310, 2465, 1629, 1781],
  [31, 20, 2368, 2526, 1744, 1904],
  [31, 21, 2427, 2590, 1861, 2031],
  [31, 22, 2488, 2654, 1982, 2160],
  [31, 23, 2550, 2721, 2105, 2293],
  [31, 24, 2614, 2789, 2232, 2429],
  [31, 25, 2679, 2858, 2362, 2569],
  [31, 26, 2746, 2930, 2495, 2712],
  [31, 27, 2815, 3003, 2631, 2858],
  [31, 28, 2885, 3078, 2771, 3008],
  [31, 29, 2957, 3155, 2914, 3162],
  [32, 1, 47, 51, 0, 0],
  [32, 2, 188, 202, 48, 54],
  [32, 3, 480, 514, 131, 145],
  [32, 4, 747, 798, 217, 239],
  [32, 5, 1065, 1137, 302, 333],
  [32, 6, 1306, 1393, 398, 438],
  [32, 7, 1554, 1657, 504, 554],
  [32, 8, 1807, 1926, 591, 650],
  [32, 9, 1852, 1974, 681, 748],
  [32, 10, 1897, 2023, 773, 848],
  [32, 11, 1944, 2074, 867, 951],
  [32, 12, 1993, 2125, 963, 1057],
  [32, 13, 2042, 2178, 1063, 1166],
  [32, 14, 2093, 2233, 1165, 1277],
  [32, 15, 2145, 2289, 1269, 1391],
  [32, 16, 2199, 2346, 1377, 1508],
  [32, 17, 2254, 2405, 1488, 1628],
  [32, 18, 2310, 2465, 1602, 1752],
  [32, 19, 2368, 2526, 1719, 1878],
  [32, 20, 2427, 2590, 1840, 2008],
  [32, 21, 2488, 2654, 1964, 2141],
  [32, 22, 2550, 2721, 2090, 2278],
  [32, 23, 2614, 2789, 2220, 2418],
  [32, 24, 2679, 2858, 2354, 2561],
  [32, 25, 2746, 2930, 2490, 2708],
  [32, 26, 2815, 3003, 2630, 2858],
  [32, 27, 2885, 3078, 2774, 3013],
  [32, 28, 2957, 3155, 2921, 3171],
  [33, 1, 49, 53, 0, 0],
  [33, 2, 193, 208, 52, 59],
  [33, 3, 493, 527, 140, 155],
  [33, 4, 767, 819, 231, 254],
  [33, 5, 1092, 1166, 322, 353],
  [33, 6, 1339, 1429, 423, 464],
  [33, 7, 1593, 1698, 535, 587],
  [33, 8, 1853, 1974, 627, 688],
  [33, 9, 1898, 2023, 721, 791],
  [33, 10, 1945, 2074, 818, 897],
  [33, 11, 1993, 2125, 918, 1005],
  [33, 12, 2042, 2179, 1020, 1117],
  [33, 13, 2093, 2233, 1125, 1231],
  [33, 14, 2145, 2289, 1233, 1348],
  [33, 15, 2199, 2346, 1343, 1469],
  [33, 16, 2254, 2405, 1457, 1592],
  [33, 17, 2310, 2465, 1574, 1719],
  [33, 18, 2368, 2526, 1695, 1849],
  [33, 19, 2427, 2590, 1819, 1983],
  [33, 20, 2488, 2654, 1947, 2119],
  [33, 21, 2550, 2721, 2077, 2260],
  [33, 22, 2614, 2789, 2211, 2403],
  [33, 23, 2679, 2858, 2348, 2551],
  [33, 24, 2746, 2930, 2489, 2702],
  [33, 25, 2815, 3003, 2633, 2856],
  [33, 26, 2885, 3078, 2781, 3015],
  [33, 27, 2957, 3155, 2932, 3178],
  [34, 1, 50, 55, 0, 0],
  [34, 2, 199, 213, 57, 63],
  [34, 3, 506, 541, 150, 166],
  [34, 4, 757, 840, 247, 270],
  [34, 5, 1120, 1196, 342, 375],
  [34, 6, 1373, 1465, 119, 492],
  [34, 7, 1633, 1741, 568, 622],
  [34, 8, 1899, 2024, 665, 728],
  [34, 9, 1946, 2074, 765, 837],
  [34, 10, 1994, 2126, 867, 948],
  [34, 11, 2043, 2179, 972, 1063],
  [34, 12, 2093, 2233, 1080, 1180],
  [34, 13, 2145, 2289, 1191, 1301],
  [34, 14, 2199, 2346, 1305, 1425],
  [34, 15, 2254, 2405, 1422, 1552],
  [34, 16, 2310, 2465, 1543, 1682],
  [34, 17, 2368, 2526, 1667, 1816],
  [34, 18, 2427, 2590, 1795, 1953],
  [34, 19, 2488, 2654, 1926, 2094],
  [34, 20, 2550, 2721, 2060, 2238],
  [34, 21, 2614, 2789, 2198, 2386],
  [34, 22, 2679, 2858, 2339, 2538],
  [34, 23, 2746, 2930, 2484, 2693],
  [34, 24, 2815, 3003, 2633, 2852],
  [34, 25, 2885, 3078, 2785, 3015],
  [34, 26, 2957, 3155, 2941, 3183],
  [35, 1, 52, 57, 0, 0],
  [35, 2, 204, 219, 61, 69],
  [35, 3, 520, 556, 162, 178],
  [35, 4, 807, 862, 264, 288],
  [35, 5, 1149, 1226, 365, 399],
  [35, 6, 1408, 1502, 478, 523],
  [35, 7, 1674, 1785, 604, 660],
  [35, 8, 1947, 2075, 707, 772],
  [35, 9, 1995, 2126, 813, 887],
  [35, 10, 2044, 2179, 921, 1005],
  [35, 11, 2094, 2233, 1033, 1126],
  [35, 12, 2146, 2289, 1147, 1251],
  [35, 13, 2199, 2346, 1265, 1378],
  [35, 14, 2254, 2405, 1386, 1509],
  [35, 15, 2310, 2465, 1510, 1643],
  [35, 16, 2368, 2526, 1638, 1781],
  [35, 17, 2427, 2590, 1770, 1923],
  [35, 18, 2488, 2654, 1905, 2068],
  [35, 19, 2550, 2721, 2044, 2217],
  [35, 20, 2614, 2789, 2186, 2369],
  [35, 21, 2679, 2858, 2332, 2525],
  [35, 22, 2746, 2930, 2482, 2685],
  [35, 23, 2815, 3003, 2635, 2849],
  [35, 24, 2885, 3078, 2792, 3018],
  [35, 25, 2957, 3155, 2953, 3190],
  [36, 1, 54, 58, 0, 0],
  [36, 2, 210, 225, 67, 74],
  [36, 3, 533, 570, 174, 190],
  [36, 4, 828, 884, 282, 308],
  [36, 5, 1179, 1258, 390, 425],
  [36, 6, 1444, 1540, 510, 556],
  [36, 7, 1717, 1830, 643, 901],
  [36, 8, 1996, 2127, 752, 820],
  [36, 9, 2045, 2180, 864, 942],
  [36, 10, 2095, 2234, 979, 1066],
  [36, 11, 2146, 2289, 1097, 1195],
  [36, 12, 2199, 2347, 1219, 1326],
  [36, 13, 2254, 2405, 1344, 1461],
  [36, 14, 2310, 2465, 1472, 1600],
  [36, 15, 2368, 2527, 1604, 1742],
  [36, 16, 2427, 2590, 1741, 1888],
  [36, 17, 2488, 2655, 1880, 2038],
  [36, 18, 2550, 2721, 2023, 2191],
  [36, 19, 2614, 2789, 2170, 2348],
  [36, 20, 2679, 2859, 2321, 2510],
  [36, 21, 2746, 2930, 2476, 2675],
  [36, 22, 2815, 3004, 2634, 2844],
  [36, 23, 2885, 3079, 2796, 3018],
  [36, 24, 2957, 3156, 2963, 3196],
  [37, 1, 55, 60, 0, 0],
  [37, 2, 216, 231, 72, 80],
  [37, 3, 548, 586, 186, 204],
  [37, 4, 850, 907, 302, 329],
  [37, 5, 1209, 1209, 416, 453],
  [37, 6, 1481, 1580, 543, 592],
  [37, 7, 1761, 1877, 685, 746],
  [37, 8, 2046, 2181, 801, 872],
  [37, 9, 2096, 2235, 919, 1001],
  [37, 10, 2148, 2290, 1041, 1134],
  [37, 11, 2201, 2347, 1167, 1270],
  [37, 12, 2255, 2406, 1296, 1409],
  [37, 13, 2310, 2466, 1428, 1553],
  [37, 14, 2368, 2528, 1565, 1700],
  [37, 15, 2428, 2591, 1706, 1851],
  [37, 16, 2488, 2656, 1850, 2006],
  [37, 17, 2551, 2722, 1998, 2164],
  [37, 18, 2614, 2790, 2150, 2327],
  [37, 19, 2680, 2860, 2306, 2494],
  [37, 20, 2747, 2931, 2466, 2664],
  [37, 21, 2815, 3005, 2629, 2840],
  [37, 22, 2886, 3080, 2797, 3019],
  [37, 23, 2958, 3157, 2969, 3203],
  [38, 1, 57, 62, 0, 0],
  [38, 2, 222, 238, 79, 87],
  [38, 3, 562, 601, 201, 220],
  [38, 4, 872, 931, 324, 352],
  [38, 5, 1241, 1324, 445, 485],
  [38, 6, 1520, 1621, 581, 633],
  [38, 7, 1806, 1925, 791, 796],
  [38, 8, 2099, 2237, 854, 930],
  [38, 9, 2150, 2292, 981, 1067],
  [38, 10, 2203, 2349, 1111, 1208],
  [38, 11, 2257, 2408, 1244, 1353],
  [38, 12, 2313, 2468, 1382, 1501],
  [38, 13, 2370, 2529, 1523, 1654],
  [38, 14, 2429, 2593, 1669, 1810],
  [38, 15, 2490, 2657, 1818, 1970],
  [38, 16, 2552, 2724, 1972, 2135],
  [38, 17, 2616, 2792, 2129, 2304],
  [38, 18, 2681, 2862, 2291, 2476],
  [38, 19, 2748, 2933, 2456, 2653],
  [38, 20, 2817, 3007, 2626, 2835],
  [38, 21, 2887, 3082, 2800, 3021],
  [38, 22, 2959, 3159, 2978, 3212],
  [39, 1, 59, 64, 0, 0],
  [39, 2, 228, 245, 85, 94],
  [39, 3, 278, 618, 216, 236],
  [39, 4, 896, 956, 348, 378],
  [39, 5, 1274, 1359, 477, 519],
  [39, 6, 1560, 1664, 622, 676],
  [39, 7, 1854, 1976, 783, 851],
  [39, 8, 2154, 2295, 914, 993],
  [39, 9, 2206, 2352, 1049, 1139],
  [39, 10, 2260, 2411, 1188, 1289],
  [39, 11, 2316, 2471, 1330, 1443],
  [39, 12, 2373, 2532, 1477, 1601],
  [39, 13, 2431, 2595, 1629, 1763],
  [39, 14, 2492, 2660, 1784, 1930],
  [39, 15, 2554, 2727, 1943, 2100],
  [39, 16, 2618, 2795, 2107, 2275],
  [39, 17, 2683, 2865, 2274, 2455],
  [39, 18, 2751, 2936, 2446, 2638],
  [39, 19, 2819, 3010, 2623, 2827],
  [39, 20, 2890, 3085, 2804, 3020],
  [39, 21, 2962, 3162, 2989, 3218],
  [40, 1, 61, 66, 0, 0],
  [40, 2, 235, 252, 93, 102],
  [40, 3, 594, 635, 234, 254],
  [40, 4, 920, 982, 375, 406],
  [40, 5, 1309, 1396, 513, 556],
  [40, 6, 1602, 1708, 668, 724],
  [40, 7, 1903, 2028, 840, 911],
  [40, 8, 2211, 2356, 981, 1063],
  [40, 9, 2264, 2414, 1125, 1218],
  [40, 10, 2320, 2474, 1274, 1379],
  [40, 11, 2377, 2536, 1426, 1543],
  [40, 12, 2436, 2599, 1584, 1712],
  [40, 13, 2496, 2664, 1746, 1885],
  [40, 14, 2558, 2730, 1911, 2062],
  [40, 15, 2622, 2799, 2082, 2244],
  [40, 16, 2687, 2869, 2256, 2431],
  [40, 17, 2755, 2940, 2435, 2622],
  [40, 18, 2823, 3014, 2619, 2818],
  [40, 19, 2894, 3089, 2808, 3019],
  [40, 20, 2966, 3166, 3001, 3224],
  [41, 1, 63, 69, 0, 0],
  [41, 2, 242, 260, 102, 111],
  [41, 3, 612, 654, 253, 275],
  [41, 4, 947, 1011, 404, 437],
  [41, 5, 1346, 1437, 553, 598],
  [41, 6, 1648, 1758, 720, 778],
  [41, 7, 1956, 2087, 904, 977],
  [41, 8, 2273, 2425, 1055, 1140],
  [41, 9, 2328, 2485, 1210, 1307],
  [41, 10, 2385, 2546, 1369, 1478],
  [41, 11, 2443, 2610, 1533, 1654],
  [41, 12, 2503, 2675, 1702, 1834],
  [41, 13, 2565, 2741, 1876, 2019],
  [41, 14, 2629, 2810, 2053, 2209],
  [41, 15, 2694, 2880, 2235, 2403],
  [41, 16, 2762, 2952, 2422, 2603],
  [41, 17, 2831, 3026, 2614, 2807],
  [41, 18, 2901, 3102, 2811, 3017],
  [41, 19, 2974, 3179, 3013, 3231],
  [42, 1, 66, 69, 0, 0],
  [42, 2, 250, 260, 111, 121],
  [42, 3, 632, 654, 274, 297],
  [42, 4, 977, 1011, 437, 472],
  [42, 5, 1389, 1437, 597, 645],
  [42, 6, 1700, 1758, 775, 838],
  [42, 7, 2018, 2087, 974, 1052],
  [42, 8, 2344, 2425, 1135, 1226],
  [42, 9, 2401, 2485, 1302, 1405],
  [42, 10, 2459, 2546, 1473, 1589],
  [42, 11, 2519, 2610, 1650, 1777],
  [42, 12, 2581, 2675, 1831, 1971],
  [42, 13, 2645, 2741, 2017, 2169],
  [42, 14, 2710, 2810, 2207, 2372],
  [42, 15, 2778, 2880, 2402, 2581],
  [42, 16, 2848, 2952, 2603, 2794],
  [42, 17, 2919, 3026, 2809, 3013],
  [42, 18, 2992, 3102, 3020, 3238],
  [43, 1, 68, 74, 0, 0],
  [43, 2, 259, 276, 121, 132],
  [43, 3, 654, 695, 299, 323],
  [43, 4, 1010, 1073, 474, 511],
  [43, 5, 1436, 1524, 646, 697],
  [43, 6, 1757, 1864, 839, 905],
  [43, 7, 2085, 2212, 1053, 1136],
  [43, 8, 2421, 2569, 1228, 1323],
  [43, 9, 2480, 2633, 1407, 1516],
  [43, 10, 2540, 2698, 1593, 1714],
  [43, 11, 2602, 2765, 1783, 1917],
  [43, 12, 2666, 2834, 1978, 2125],
  [43, 13, 2731, 2904, 2178, 2338],
  [43, 14, 2799, 2977, 2382, 2557],
  [43, 15, 2869, 3051, 2593, 2781],
  [43, 16, 2941, 3128, 2809, 3011],
  [43, 17, 3014, 3206, 3030, 3246],
  [44, 1, 71, 76, 0, 0],
  [44, 2, 269, 285, 134, 145],
  [44, 3, 677, 717, 326, 352],
  [44, 4, 1046, 1106, 516, 555],
  [44, 5, 1485, 1570, 703, 756],
  [44, 6, 1816, 1920, 912, 981],
  [44, 7, 2156, 2279, 1144, 1230],
  [44, 8, 2503, 2646, 1333, 1433],
  [44, 9, 2563, 2711, 1528, 1641],
  [44, 10, 2625, 2778, 1729, 1854],
  [44, 11, 2689, 2847, 1934, 2073],
  [44, 12, 2755, 2918, 2145, 2298],
  [44, 13, 2822, 2991, 2361, 2528],
  [44, 14, 2893, 3065, 2582, 2763],
  [44, 15, 2965, 3142, 2809, 3005],
  [44, 16, 3039, 3221, 3043, 3253],
  [45, 1, 74, 79, 0, 0],
  [45, 2, 278, 294, 147, 159],
  [45, 3, 700, 739, 357, 385],
  [45, 4, 1081, 1139, 564, 606],
  [45, 5, 1535, 1617, 767, 824],
  [45, 6, 1877, 1977, 994, 1068],
  [45, 7, 2227, 2346, 1246, 1339],
  [45, 8, 2585, 2723, 1452, 1559],
  [45, 9, 2647, 2791, 1663, 1784],
  [45, 10, 2711, 2860, 1881, 2016],
  [45, 11, 2777, 2930, 2103, 2253],
  [45, 12, 2845, 3003, 2331, 2496],
  [45, 13, 2915, 3078, 2565, 2745],
  [45, 14, 2987, 3155, 2806, 3001],
  [45, 15, 3062, 3234, 3052, 3263],
  [46, 1, 77, 82, 13, 15],
  [46, 2, 289, 304, 163, 176],
  [46, 3, 725, 762, 419, 450],
  [46, 4, 1119, 1175, 655, 702],
  [46, 5, 1588, 1668, 934, 1001],
  [46, 6, 1942, 2038, 1146, 1228],
  [46, 7, 2303, 2418, 1364, 1461],
  [46, 8, 2674, 2807, 1590, 1701],
  [46, 9, 2738, 2876, 1820, 1946],
  [46, 10, 2803, 2947, 2057, 2198],
  [46, 11, 2871, 3020, 2299, 2456],
  [46, 12, 2941, 3095, 2548, 2720],
  [46, 13, 3013, 3712, 2803, 2991],
  [46, 14, 3088, 3251, 3065, 3269],
  [47, 1, 80, 85, 15, 17],
  [47, 2, 299, 314, 183, 196],
  [47, 3, 751, 786, 468, 499],
  [47, 4, 1158, 1212, 729, 776],
  [47, 5, 1643, 1719, 1039, 1106],
  [47, 6, 2008, 2100, 1274, 1356],
  [47, 7, 2382, 2491, 1516, 1612],
  [47, 8, 2765, 2892, 1764, 1875],
  [47, 9, 2830, 2963, 2019, 2145],
  [47, 10, 2898, 3036, 2279, 2421],
  [47, 11, 2968, 3111, 2546, 2704],
  [47, 12, 3040, 3188, 2820, 2994],
  [47, 13, 3115, 3268, 3101, 3292],
  [48, 1, 83, 88, 17, 19],
  [48, 2, 310, 324, 205, 219],
  [48, 3, 777, 811, 523, 556],
  [48, 4, 1198, 1250, 814, 862],
  [48, 5, 1699, 1772, 1158, 1226],
  [48, 6, 2076, 2165, 1419, 1502],
  [48, 7, 2462, 2568, 1687, 1785],
  [48, 8, 2857, 2960, 1962, 2075],
  [48, 9, 2925, 3053, 2243, 2372],
  [48, 10, 2995, 3128, 2531, 2676],
  [48, 11, 3067, 3206, 2827, 2988],
  [48, 12, 3142, 3285, 3129, 3308],
  [49, 1, 87, 91, 20, 22],
  [49, 2, 321, 335, 232, 246],
  [49, 3, 805, 837, 589, 622],
  [49, 4, 1240, 1289, 913, 963],
  [49, 5, 1758, 1827, 1298, 1368],
  [49, 6, 2148, 2231, 1590, 1675],
  [49, 7, 2546, 2646, 1888, 1989],
  [49, 8, 2954, 3071, 2194, 2311],
  [49, 9, 3024, 3146, 2507, 2640],
  [49, 10, 3096, 3223, 2828, 2978],
  [49, 11, 3170, 3302, 3156, 3324],
  [50, 1, 90, 94, 23, 25],
  [50, 2, 333, 346, 266, 279],
  [50, 3, 833, 863, 670, 702],
  [50, 4, 1283, 1328, 1035, 1085],
  [50, 5, 1818, 1883, 1471, 1540],
  [50, 6, 2220, 2299, 1799, 1883],
  [50, 7, 2632, 2726, 2135, 2235],
  [50, 8, 3053, 3163, 2479, 2595],
  [50, 9, 3125, 3241, 2831, 2964],
  [50, 10, 3199, 3320, 3191, 3342],
  [51, 1, 94, 98, 83, 86],
  [51, 2, 347, 358, 308, 320],
  [51, 3, 867, 893, 772, 801],
  [51, 4, 1334, 1374, 1190, 1234],
  [51, 5, 1890, 1947, 1688, 1749],
  [51, 6, 2307, 2377, 2062, 2137],
  [51, 7, 2734, 2817, 2445, 2535],
  [51, 8, 3171, 3269, 2836, 2942],
  [51, 9, 3244, 3348, 3237, 3359],
  [52, 1, 98, 101, 97, 101],
  [52, 2, 361, 371, 357, 370],
  [52, 3, 900, 924, 891, 921],
  [52, 4, 1384, 1420, 1370, 1417],
  [52, 5, 1960, 2011, 1940, 2007],
  [52, 6, 2392, 2455, 2367, 2450],
  [52, 7, 2833, 2909, 2805, 2904],
  [52, 8, 3285, 3375, 3252, 3369],
  [53, 1, 0, 0, 116, 120],
  [53, 2, 0, 0, 420, 434],
  [53, 3, 0, 0, 1044, 1078],
  [53, 4, 0, 0, 1603, 1654],
  [53, 5, 0, 0, 2267, 2341],
  [53, 6, 0, 0, 2764, 2855],
  [53, 7, 0, 0, 3273, 3382],
  [54, 1, 0, 0, 142, 146],
  [54, 2, 0, 0, 507, 522],
  [54, 3, 0, 0, 1255, 1290],
  [54, 4, 0, 0, 1921, 1976],
  [54, 5, 0, 0, 2714, 2793],
  [54, 6, 0, 0, 3306, 3404],
  [55, 1, 0, 0, 179, 183],
  [55, 2, 0, 0, 632, 646],
  [55, 3, 0, 0, 1558, 1593],
  [55, 4, 0, 0, 2380, 2435],
  [55, 5, 0, 0, 3358, 3437]

];

// --- 2. สร้างฟังก์ชัน Builder เพื่อแปลงข้อมูลดิบ ---
const buildCsvTable = () => {
    const table: Record<PensionPlanType, Record<Gender, Record<string, { policyYear: number; csvRate: number }[]>>> = {
        pension8: {
            male: {},
            female: {}
        },
        pension60: {
            male: {},
            female: {}
        }
    };

    for (const row of rawCsvData) {
        const [entryAge, policyYear, csv8Male, csv8Female, csv60Male, csv60Female] = row;
        const ageKey = String(entryAge);

        if (!table.pension8.male[ageKey]) table.pension8.male[ageKey] = [];
        if (!table.pension8.female[ageKey]) table.pension8.female[ageKey] = [];
        if (!table.pension60.male[ageKey]) table.pension60.male[ageKey] = [];
        if (!table.pension60.female[ageKey]) table.pension60.female[ageKey] = [];
        
        table.pension8.male[ageKey].push({ policyYear, csvRate: csv8Male });
        table.pension8.female[ageKey].push({ policyYear, csvRate: csv8Female });
        table.pension60.male[ageKey].push({ policyYear, csvRate: csv60Male });
        table.pension60.female[ageKey].push({ policyYear, csvRate: csv60Female });
    }
    return table;
};

// --- 3. เรียกใช้ Builder และ Export ผลลัพธ์สุดท้าย ---
const pensionCsvTableData = buildCsvTable();

// --- 4. ฟังก์ชันค้นหาที่ถูกต้อง (รับ 4 arguments) ---
export const getPensionCsvRatePer1000 = (entryAge: number, gender: Gender, policyYear: number, plan: PensionPlanType): number => {
    const planTable = pensionCsvTableData[plan];
    if (!planTable) return 0;

    const genderTable = planTable[gender];
    if (!genderTable) return 0;

    const ageTable = genderTable[String(entryAge)];
    if (!ageTable) return 0;

    const record = ageTable.find(r => r.policyYear === policyYear);
    return record ? record.csvRate : 0;
};